# loopback3-server
The project is generated by [LoopBack](http://loopback.io). 

It creates an ACL enabled REST API with a few models connected to a mongodb.

Check out a live demo [here](https://uiseguys-loopback3-server.herokuapp.com/explorer/). 

Install dependencies

```npm install```

Spin up the server

```npm start```

Navigate to ```http://localhost:3000/explorer``` to see a list of models and all available operations.

Edit ```server/datasources.json``` to point to your own db

Edit models in ```common``` folder or use loopback CLI to create new ones or update existing ones. Refer to loopback docs on models JSON structure.

Provided models are 
* Driver (restricted to _admin_ role)
* Vehicle (restricted to _authenticated_ users)
* Log (unrestricted)

Loopback generates access control related models (_User, Role, RoleMapping_). Once again, refer to loopback docs for info on those.

Edit ```boot/users.js``` to create/update users and roles in db on each startup.

---

Use curl or postman to access the api at ```http://localhost:3000/api```

For example 

* GET http://localhost:3000/api/Logs

should return 

```
[
    {
        "text": "this is a log",
        "id": "5a674cf651635e4d88f7e017"
    },
    {
        "text": "this is another log",
        "id": "5a674cfa51635e4d88f7e018"
    }
]
```

---

Login with credentials ```{"username": "admin", "password": "1234"}``` through a POST request to ```http://localhost:3000/api/Users/login``` or in _explorer_ at ```/User/login``` route

Use the generated token (_id_ field in the response) as an access token (_access\_token_ query param) in subsequent requests to restricted models.

For example: 

```http://localhost:3000/api/Drivers?access_token=CfMHblcKO5qeoFYKjbLepu7qlxYiee5wBT2t1iC4IlOwE2oNLtA00FphafvlbYAa```

---

